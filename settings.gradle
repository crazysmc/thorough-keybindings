pluginManagement {
  repositories {
    maven {
      name = 'Fabric'
      url = 'https://maven.fabricmc.net/'
    }
    maven {
      name = 'Ornithe Releases'
      url = 'https://maven.ornithemc.net/releases'
    }
    maven {
      name = 'Ornithe Snapshots'
      url = 'https://maven.ornithemc.net/snapshots'
    }
    gradlePluginPortal()
  }
}

dependencyResolutionManagement {
  versionCatalogs {
    libs {
      version 'loom', '1.6-SNAPSHOT'
      library 'loader', 'net.fabricmc', 'fabric-loader' version '0.15.9'
      library 'junit', 'org.junit.jupiter', 'junit-jupiter' version '5.10.2'

      def fabric = { v, y, f -> [mc: v, r: "~$v", yarn: "$v+build.$y", fapi: f] }
      def fabricExact = { v, y, f -> [mc: v, r: "=$v", yarn: "$v+build.$y", fapi: f] }

      def i = startParameter.projectProperties.preset as Integer ?: 0
      def conf = [
////          fabricExact('1.14', 21, '0.28.5+1.14'),
////          fabricExact('1.14.1', 10, '0.28.5+1.14'),
////          fabricExact('1.14.2', 7, '0.28.5+1.14'),
//          fabric('1.14.3', 13, '0.28.5+1.14'),
////          fabric('1.14.4', 18, '0.28.5+1.14'),
//          fabric('1.15', 2, '0.28.5+1.15'),
          fabric('1.16', 4, '0.42.0+1.16'),
      ][i]
      // for p in {0..0}; do ./gradlew :mod:build -Ppreset=$p; done

      version 'minecraft', conf.mc
      version 'range', conf.r
      library 'minecraft', 'com.mojang', 'minecraft' versionRef 'minecraft'
      library 'yarn', 'net.fabricmc', 'yarn' version conf.yarn
      library 'fapi', 'net.fabricmc.fabric-api', 'fabric-api' version conf.fapi
    }
  }
}

include ':ap'
include ':mod'
